{# @var craft \craft\web\twig\variables\CraftVariable #}
{% extends "_layouts/_layout.twig" %}

{% block _inline_css %}
    <style>
        {{ source ("index_critical.min.css", ignore_missing = true) }}
    </style>
{% endblock %}

{% block content %}

<!-- Home Hero -->
<section class="section is-large is-dark is-vertical-center has-background is-background-container hero home animatable">
    <div class="background-image-container">
        <div class="transition-helper">
            <video autoplay="autoplay" muted="muted" loop="loop" id="myVideo" data-object-fit>
                <source src="{{ baseUrl }}img/temp/home-video.mp4" type="video/mp4">
            </video>
        </div>
    </div>
    <div class="container is-small hero-content">
        <h1 class="is-large heading-title-wrap"><span class="heading-title">{{ entry.heroHeading }}</span></h1>
        <p>{{ entry.heroDescription }}</p>
    </div>
</section>

<!-- Home Case Study Grid -->
{# Get project entries - up to 3 #}
{# eager load to avoid N+1 query issues #}
{# To add transforms, use this snippet - 
    .with ([
        [
            'heroFeaturedImage', {
                withTransforms: ['medium']
            }
        ]
    ])
#}
{% set projects = craft
    .entries()
    .section('work')
    .with ([
        [
            'thumbnail', {
                withTransforms: ['portfolioThumb']
            }
        ]
    ]) 
    .limit(4)
    .all() %}

<section class="section is-medium case-list home">
    <div class="container animatable">
        <header class="container animatable">
            <p class="is-subheading heading-title-wrap">
                <span class="heading-title">OUR WORK</span>
            </p>
            <h1 class="heading-title-wrap">
                <span class="heading-title">Some of our favorite projects.</span>
            </h1>
        </header>
        {% for batchedProjects in projects | batch(2) %}
            <div class="tile is-ancestor is-block-tablet is-block-desktop is-flex-widescreen">
                {% for project in batchedProjects %}
                    <div class="tile is-parent animatable">
                        <a class="tile-link-wrapper" href="{{ project.uri }}">
                            <article class="tile is-child">
                                <div class="transition-helper">
                                    {% set image = project.thumbnail[0] %}
                                    <img class="cover" src="{{ image.getUrl('portfolioThumb') }}" title="{{ image.title }}" alt="{{ image.title }}" data-object-fit>
                                </div>
                                <div class="description">
                                    <h3 class="heading-title-wrap animatable"><span class="heading-title">{{ project.heroSubheading | title }}</span></h3>
                                    <p>
                                        {{ project.shortDescription }}
                                    </p>
                                </div>
                            </article>
                        </a>
                    </div>
                {% endfor %}
            </div>
        {% endfor %}
    </div>
</section>

<!-- Home Secondary Headline -->
<section class="section is-medium is-off-white has-background text-heading-left animatable">
    <div class="container is-small">
        <div class="columns">
            <div class="column is-two-fifths">
                <h2 class="heading-title-wrap animatable">
                    <span class="heading-title">We have big dreams too.</span>
                </h2>
            </div>
            <div class="column">
                <p class="animatable">
                    We are inspired by a passion for great design, and we deliver outstanding results driven by our experience, dedication, and attention to detail.<br>
                    <a class="button text-button" href="{{ baseUrl }}about">Learn more</a>
                </p>
            </div>
        </div>
    </div>
</section>

<!-- Home Services -->
<section class="section is-medium is-dark has-background services animatable">
    <header class="container is-small animatable">
        <p class="is-subheading heading-title-wrap"><span class="heading-title">WHAT WE DO</span></p>
        <h1 class="heading-title-wrap"><span class="heading-title">Our Services</span></h1>
    </header>
    <div class="container">
        <div class="columns is-desktop is-gapless is-multiline">
            <div class="column">
                {% for service in entry.servicesGrid.limit(2).all() %}
                    <a href="{{ service.serviceLink }}">
                        <article class="service is-dark is-background-container animatable">
                            <div class="background-image-container">
                                <div class="transition-helper">
                                    {% set backgroundImage = service.backgroundImage.one() %}
                                    <img class="image js-mouse-tilt-hover" src="{{ backgroundImage.getUrl('small') }}" title="{{ backgroundImage.title }}" alt="{{ backgroundImage.title }}" data-object-fit>
                                </div>
                            </div>
                            <h3 class="heading-title-wrap"><span class="heading-title">{{ service.serviceTitle }}</span></h3>
                        </article>
                    </a>
                {% endfor %}
            </div>
            <div class="column">
                {% for service in entry.servicesGrid.offset(2).limit(2).all() %}
                    <a href="{{ service.serviceLink }}">
                        <article class="service is-dark is-background-container animatable">
                            <div class="background-image-container">
                                <div class="transition-helper">
                                    {% set backgroundImage = service.backgroundImage.one() %}
                                    <img class="image js-mouse-tilt-hover" src="{{ backgroundImage.getUrl('small') }}" title="{{ backgroundImage.title }}" alt="{{ backgroundImage.title }}" data-object-fit>
                                </div>
                            </div>
                            <h3 class="heading-title-wrap"><span class="heading-title">{{ service.serviceTitle }}</span></h3>
                        </article>
                    </a>
                {% endfor %}
            </div>
        </div>
    </div>
</section>

{% endblock %}

{% block _inline_js %}
{% endblock %}